<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MysticWeather</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Courier Prime', monospace;
            background-color: #000;
            color: #00ff00;
        }
        .glow {
            text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00;
        }
        .container-shadow {
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }
        .loading-animation::after {
            content: '';
            animation: typing 1.5s steps(20, end) infinite;
        }
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <div class="w-full max-w-2xl bg-black border-2 border-green-500 rounded-lg container-shadow p-8 transition-all duration-300">
        <div class="flex flex-col items-center text-center">
            <h1 class="text-4xl font-bold glow mb-2">MYSTICWEATHER</h1>
            <p class="text-green-300 mb-6"> > SYSTEM READY. AWAITING COMMAND.</p>
        </div>

        <!-- Command Line Interface -->
        <div class="mb-6">
            <div class="flex items-center space-x-2">
                <span class="text-green-300">> /weather/query/</span>
                <input type="text" id="location-input" placeholder="location"
                       class="flex-grow bg-transparent text-green-400 border-b-2 border-green-500 focus:outline-none focus:border-green-300 transition duration-200">
                <button id="search-button" class="bg-green-700 text-white p-2 rounded-md font-semibold hover:bg-green-600 transition duration-200">
                    EXECUTE
                </button>
            </div>
        </div>

        <!-- Terminal Output -->
        <div id="output-terminal" class="bg-gray-900 border border-green-500 container-shadow p-4 rounded-md h-96 overflow-y-auto">
            <p id="initial-message" class="text-green-500">> _</p>
        </div>

        <!-- Message Box -->
        <div id="message-box" class="fixed inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center p-4 hidden">
            <div class="bg-gray-800 border-2 border-green-500 rounded-lg p-6 shadow-2xl max-w-sm w-full text-center">
                <p id="message-text" class="text-green-300 font-medium"></p>
                <button id="close-message" class="mt-4 bg-green-700 text-white p-2 px-4 rounded-md font-semibold hover:bg-green-600">
                    DISMISS
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchButton = document.getElementById('search-button');
            const locationInput = document.getElementById('location-input');
            const outputTerminal = document.getElementById('output-terminal');
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');
            const closeMessageButton = document.getElementById('close-message');

            // IMPORTANT: Replace 'YOUR_API_KEY' with your valid WeatherAPI.com key
            const API_KEY = '7a7e968d1556475b8b994242250409';
            
            const showMessage = (text) => {
                messageText.textContent = text;
                messageBox.classList.remove('hidden');
            };

            const hideMessage = () => {
                messageBox.classList.add('hidden');
            };

            closeMessageButton.addEventListener('click', hideMessage);

            const displayOutput = (text) => {
                const line = document.createElement('p');
                line.textContent = text;
                line.classList.add('text-green-500');
                outputTerminal.appendChild(line);
                outputTerminal.scrollTop = outputTerminal.scrollHeight;
            };

            const simulateTyping = (text, delay = 50) => {
                return new Promise(resolve => {
                    let i = 0;
                    const p = document.createElement('p');
                    p.classList.add('text-green-500', 'loading-animation');
                    outputTerminal.appendChild(p);
                    const interval = setInterval(() => {
                        p.textContent = text.substring(0, i + 1);
                        outputTerminal.scrollTop = outputTerminal.scrollHeight;
                        if (i < text.length) {
                            i++;
                        } else {
                            clearInterval(interval);
                            p.classList.remove('loading-animation');
                            resolve();
                        }
                    }, delay);
                });
            };

            const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            const fetchWeatherData = async (location) => {
                if (API_KEY === 'YOUR_API_KEY') {
                    showMessage("API KEY ERROR: PLEASE REPLACE 'YOUR_API_KEY' WITH A VALID KEY FROM WEATHERAPI.COM.");
                    return;
                }
                
                outputTerminal.innerHTML = '';
                displayOutput(`> EXECUTING QUERY FOR LOCATION: ${location.toUpperCase()}`);

                try {
                    await wait(500);
                    await simulateTyping('> PINGING MYSTICWEATHER...');

                    // Fetch current weather
                    const url = `https://api.weatherapi.com/v1/forecast.json?key=${API_KEY}&q=${location}&days=5`;
                    const response = await fetch(url);
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error.message);
                    }
                    const data = await response.json();

                    await simulateTyping('> ESTABLISHING SECURE CONNECTION... VERIFIED');
                    await wait(1000);
                    await simulateTyping('> DECRYPTING DATA STREAM...');
                    await wait(2000);
                    
                    displayOutput(' ');
                    displayOutput('---------------------------------');
                    displayOutput(`> LOCATION: ${data.location.name.toUpperCase()}, ${data.location.country}`);
                    displayOutput(`> CURRENT TEMP: ${Math.round(data.current.temp_c)}°C`);
                    displayOutput(`> CONDITIONS: ${data.current.condition.text}`);
                    displayOutput(`> WIND SPEED: ${Math.round(data.current.wind_kph)} km/h`);
                    displayOutput('---------------------------------');

                    displayOutput(' ');
                    displayOutput('> FORECASTING...');
                    displayOutput('---------------------------------');

                    // Display the next 5 days
                    data.forecast.forecastday.forEach(day => {
                        const date = new Date(day.date).toLocaleDateString('en-US', { weekday: 'short' });
                        displayOutput(`> ${date}: ${day.day.condition.text} | ${Math.round(day.day.maxtemp_c)}°C / ${Math.round(day.day.mintemp_c)}°C`);
                    });

                    displayOutput('---------------------------------');
                    displayOutput(' ');
                    displayOutput('> QUERY COMPLETE. SYSTEM IDLE.');

                } catch (error) {
                    displayOutput(`> ERROR: ${error.message.toUpperCase()}`);
                    displayOutput('> SYSTEM FAILED. PLEASE TRY AGAIN.');
                    console.error('API Error: ', error);
                }
            };

            const handleSearch = () => {
                const location = locationInput.value.trim();
                if (!location) {
                    showMessage("QUERY DENIED: LOCATION FIELD EMPTY.");
                    return;
                }
                fetchWeatherData(location);
            };

            searchButton.addEventListener('click', handleSearch);

            locationInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleSearch();
                }
            });
        });
    </script>
</body>
</html>
